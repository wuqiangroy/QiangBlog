{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}
{% import "_macros.html" as macros %}

{% block title %}QiangBlog - Post{% endblock %}

{% block page_content %}
<div>
    <ul class="posts">
        <div class="page-header" >
            <h1 style="text-align: center">{{ post.title }}</h1>
        </div>
        <div style="text-align: center">
            <a href="{{ url_for('main.profile', username=post.author.username) }}">
                <img class="img-rounded" src="{{ post.author.gravatar(size=40) }}">
            </a>
            <a href="{{ url_for('main.profile', username=post.author) }}">{{ post.author.username }}</a>

            发布时间： {{ moment(post.create_time).format("LLL") }}
        </div>

        <div class="post-content" style="text-align: center">

        </div>
        <br>
        <br>
        <div class="post-body">
            {% if post.content_html %}
            {{ post.content_html | safe }}
            {% else %}
            {{ post.content }}
            {% endif %}
        </div>
        <br>
        <br>
        <div class="post-footer">
            {% if current_user == post.author %}
            <a href="{{ url_for('main.edit_post', id=post.id )}}">
                <span class="label label-primary">编辑</span>
            </a>
            <a href="{{ url_for('main.delete_post', id=post.id )}}">
                <span class="label label-danger">删除</span>
            </a>
            {% elif current_user.can(Permission.ADMINISTER) %}
            <a href="{{ url_for('main.edit_post', id=post.id )}}">
                <span class="label label-danger">编辑[管理员]</span>
            </a>
            <a href="{{ url_for('main.delete_post', id=post.id )}}">
                <span class="label label-danger">删除[管理员]</span>
            </a>
            {% endif %}
        </div>
    </ul>
</div>
<hr/>
<h4 id="comments">评论</h4>
{% include '_comments.html' %}
{% if pagination %}
<div class="pagination">
    {{ macros.pagination_widget(pagination, 'main.post_page', fragment='#comments', id=post.id) }}
</div>
{% endif %}
{% if current_user.can(Permission.COMMENT) %}
<div class="comment-form">
    {{ wtf.quick_form(form) }}
</div>
{% endif %}
{% endblock %}
